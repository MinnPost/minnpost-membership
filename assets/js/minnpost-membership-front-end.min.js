"use strict";!function(e){function t(e,t){this.data={},void 0!==e&&(this.data=e),this.settings={},void 0!==t&&(this.settings=t),this.previousAmount="",void 0!==this.data.current_user&&void 0!==this.data.current_user.previous_amount&&(this.previousAmount=this.data.current_user.previous_amount)}t.prototype={checkLevel:function(e,t,n){var i=parseInt(e)*parseInt(t);if(void 0!==this.previousAmount&&""!==this.previousAmount){var s=parseInt(this.previousAmount.prior_year_contributions,10),a=parseInt(this.previousAmount.coming_year_contributions,10),l=parseInt(this.previousAmount.annual_recurring_amount,10);"one-time"===n?s+=i:l+=i,i=Math.max(s,a,l)}return this.getLevel(i)},getLevel:function(e){var t={};return 0<e&&e<60?(t.name="Bronze",t.number=1):59<e&&e<120?(t.name="Silver",t.number=2):119<e&&e<240?(t.name="Gold",t.number=3):239<e&&(t.name="Platinum",t.number=4),t}},e.MinnPostMembership=new t(e.minnpost_membership_data,e.minnpost_membership_settings)}(window),function(l,e,t,a){var n="minnpostAmountSelect",i={frequencySelector:'.m-frequency-select input[type="radio"]',amountGroup:".m-frequency-group",amountSelector:'.m-amount-select input[type="radio"]',amountLabels:".m-amount-select label",amountValue:"strong",amountDescription:".a-amount-description",amountField:".a-amount-field #amount",levelViewer:".a-show-level",levelName:".a-level",userCurrentLevel:".a-current-level",declineBenefits:'.m-decline-benefits-select input[type="radio"]',giftSelector:".m-membership-gift-selector",subscriptionsSelector:'.m-select-subscription input[type="checkbox"]',declineSubscriptions:"#subscription-decline"};function s(e,t){this.element=e,this.options=l.extend({},i,t),this._defaults=i,this._name=n,this.init()}s.prototype={init:function(){var e=l(this.element).find(this.options.frequencySelector),t=l(this.options.amountSelector),n=l(this.element).find(this.options.amountField),i=l(this.element).find(this.options.declineBenefits),s=l(this.element).find(this.options.subscriptionsSelector);0<n.length&&0<e.length&&0<t.length&&(this.setAmountLabels(e.filter(":checked").val()),this.checkAndSetLevel(),e.on("change",this.onFrequencyChange.bind(this)),t.on("change",this.onSuggestedAmountChange.bind(this)),n.on("keyup mouseup",this.onAmountChange.bind(this)),0<i.length&&0<s.length&&(s.not(this.options.declineSubscriptions).is(":checked")&&l(this.element).find(this.options.declineSubscriptions).prop("checked",!1),this.onDeclineBenefitsChange(),i.on("change",this.onDeclineBenefitsChange.bind(this)),s.on("click",this.onSubscriptionsClick.bind(this))))},onFrequencyChange:function(e){this.setAmountLabels(l(e.target).val()),this.checkAndSetLevel()},onSuggestedAmountChange:function(e){l(this.element).find(this.options.amountField).val(null),this.checkAndSetLevel()},onAmountChange:function(e){this.clearAmountSelector(e);var t=l(e.target);t.data("last-value")!=t.val()&&(t.data("last-value",t.val()),this.checkAndSetLevel())},onDeclineBenefitsChange:function(e){var t=l(this.element).find(this.options.giftSelector);"true"!==l(this.element).find(this.options.declineBenefits).filter(":checked").val()?t.show():t.hide()},onSubscriptionsClick:function(e){var t=l(this.element).find(this.options.subscriptionsSelector).not(this.options.declineSubscriptions),n=l(this.element).find(this.options.declineSubscriptions);l(e.target).is(this.options.declineSubscriptions)?t.prop("checked",!1):n.prop("checked",!1)},clearAmountSelector:function(e){var t=l(this.options.amountSelector);""!==l(e.target).val()&&t.removeAttr("checked")},setAmountLabels:function(e){var t=l(this.options.amountGroup),n=l(this.options.amountSelector).filter(":checked"),i=n.data("index");t.removeClass("active"),t.filter('[data-frequency="'+e+'"]').addClass("active"),n.prop("checked",!1),t.filter(".active").find('input[type="radio"][data-index="'+i+'"]').prop("checked",!0)},checkAndSetLevel:function(){var e=l(this.options.amountSelector).filter(":checked").val();void 0===e&&(e=l(this.options.amountField).val());var t=l(this.options.frequencySelector+":checked").val(),n=t.split(" - ")[1],i=t.split(" - ")[0],s=a.checkLevel(e,n,i);this.showNewLevel(this.element,this.options,s)},showNewLevel:function(e,t,n){var i="",s=t.levelViewer,a=function(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)})};"undefined"!=typeof minnpost_membership_data&&(i=minnpost_membership_data.member_level_prefix),0<l(t.levelViewer).length&&(l(t.levelViewer).prop("class","a-show-level a-show-level-"+n.name.toLowerCase()),0<l(t.userCurrentLevel).length&&0<minnpost_membership_data.current_user.member_level.length&&(0<l(t.levelViewer).length&&(s=t.levelViewer+" a"),minnpost_membership_data.current_user.member_level.replace(i,"")!==n.name.toLowerCase()?l(s).html(a(l(t.levelViewer).data("changed"))):l(s).html(a(l(t.levelViewer).data("not-changed")))),l(t.levelName,t.levelViewer).text(n.name))}},l.fn[n]=function(e){return this.each(function(){l.data(this,"plugin_"+n)||l.data(this,"plugin_"+n,new s(this,e))})}}(jQuery,window,document,MinnPostMembership),function(l){l(document).ready(function(){0<l(".m-form-membership-benefit").length&&(2===performance.navigation.type&&location.reload(!0),l(".a-benefit-button.a-button-disabled").removeAttr("disabled"),l(".a-benefit-button").click(function(e){e.preventDefault();var n=l(this),i=l(".m-benefit-message",l(this).parent()),s=l("select",l(this).parent()),t=minnpost_membership_settings;n.text("Processing").addClass("a-button-disabled"),l(".a-benefit-button").addClass("a-button-disabled");var a={};"partner-offers"===l('input[name="benefit-name"]').val()&&(a={action:"benefit_form_submit",minnpost_membership_benefit_form_nonce:n.data("benefit-nonce"),current_url:l('input[name="current_url"]').val(),"benefit-name":l('input[name="benefit-name"]').val(),instance_id:l('[name="instance-id-'+n.val()+'"]').val(),post_id:n.val(),is_ajax:"1"},l.post(t.ajaxurl,a,function(t){!0===t.success?(n.val(t.data.button_value).text(t.data.button_label).removeClass("a-button-disabled").addClass(t.data.button_class).prop(t.data.button_attr,!0),i.html(t.data.message).addClass("m-benefit-message-visible "+t.data.message_class),0<s.length&&s.prop("disabled",!0),l(".a-benefit-button").not(n).val(t.data.button_value).attr("disabled",!0)):(void 0===t.data.remove_instance_value||l("option",s).each(function(e){l(this).val()===t.data.remove_instance_value&&l(this).remove()}),""!==t.data.button_label?(n.show(),n.val(t.data.button_value).text(t.data.button_label).removeClass("a-button-disabled").addClass(t.data.button_class).prop(t.data.button_attr,!0)):n.hide(),l(".a-benefit-button").not(n).removeClass("a-button-disabled"),i.html(t.data.message).addClass("m-benefit-message-visible "+t.data.message_class))}))}))}),l(".a-refresh-page").click(function(e){e.preventDefault(),location.reload()})}(jQuery),function(o){o(document).ready(function(){o(".m-support-cta-top .a-support-button").click(function(e){var t,n,i,s,a,l="";0<o("svg",o(this)).length&&(l=o("svg",o(this)).attr("title")+" "),l+=o(this).text(),t="event",n="Support CTA - Header",i="Click: "+l,s=location.pathname,"undefined"!=typeof ga&&(void 0===a?ga("send",t,n,i,s):ga("send",t,n,i,s,a))})})}(jQuery),function(u,e,t,l,n){var i="minnpostMembership",s={debug:!1,amount_viewer:".amount h3",frequency_selector_in_levels:".a-form-item-membership-frequency",frequency_selector_in_levels_type:"select",levels_container:".o-membership-member-levels",single_level_container:".m-membership-member-level",single_level_summary_selector:".m-member-level-brief",flipped_items:"div.amount, div.enter",level_frequency_text_selector:".show-frequency",choose_amount_selector_in_levels:".amount .a-button-flip",amount_selector_in_levels:".enter input.amount-entry"};function a(e,t){this.element=e,this.options=u.extend({},s,t),this._defaults=s,this._name=i,this.init()}a.prototype={init:function(e,t){this.catchHashLinks(this.element,this.options),this.levelFlipper(this.element,this.options),this.startLevelClick(this.element,this.options)},catchHashLinks:function(e,t){u('a[href*="#"]:not([href="#"])',e).click(function(e){var t;if(0==(t=u(e.target)).parent(".comment-title").length&&location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname&&(t=(t=u(this.hash)).length?t:u("[name="+this.hash.slice(1)+"]")).length)return u("html,body").animate({scrollTop:t.offset().top},1e3),!1})},levelFlipper:function(t,n){var i=this,s=0,a="",l=0,o="",r="",c="";0<u(n.levels_container).length&&(u(n.single_level_summary_selector,t).each(function(){u(n.flipped_items,u(this)).wrapAll('<div class="flipper"/>')}),u(n.frequency_selector_in_levels,t).on("change",function(e){l=u(this).data("member-level-number"),o=u(this).val(),r=o.split(" - ")[1],c=o.split(" - ")[0],void 0!==l?(u(n.single_level_summary_selector,t).removeClass("flipped"),u(n.single_level_container,t).removeClass("active"),u(e.target).closest(n.single_level_summary_selector).addClass("flipped"),1==r?u(n.amount_selector_in_levels,u(n.single_level_container+"-"+l)).val(u(n.amount_viewer,u(n.single_level_container+"-"+l)).data("default-yearly")):12==r&&u(n.amount_selector_in_levels,u(n.single_level_container+"-"+l)).val(u(n.amount_viewer,u(n.single_level_container+"-"+l)).data("default-monthly")),s=u(n.amount_selector_in_levels+'[data-member-level-number="'+l+'"]').val(),a=i.checkLevel(s,r,c,t,n),i.changeFrequency(o,a.name,t,n)):0<u(n.level_frequency_text_selector).length&&(u(n.level_frequency_text_selector,t).text(c),u(n.single_level_container).each(function(){void 0!==(l=u(n.amount_selector_in_levels,u(this)).data("member-level-number"))&&(s=u(n.amount_selector_in_levels,u(this)).val(),a=i.checkLevel(s,r,c,t,n))})),i.changeAmountPreview(o,a.name,t,n)})),0<u(n.choose_amount_selector_in_levels).length&&u(n.choose_amount_selector_in_levels,t).click(function(e){l=u(n.frequency_selector_in_levels,t).data("member-level-number"),u(n.single_level_summary_selector,t).removeClass("flipped"),u(n.single_level_container,t).removeClass("active"),u(e.target).closest(n.single_level_summary_selector).addClass("flipped"),o=u(n.frequency_selector_in_levels,u(this).parent()).val(),r=o.split(" - ")[1],s=u(n.amount_selector_in_levels+'[data-member-level-number="'+l+'"]').val(),a=i.checkLevel(s,r,c,t,n),e.preventDefault()})},checkLevel:function(e,t,n,i,s){var a=l.checkLevel(e,t,n);return u("h2",s.single_level_summary_selector).each(function(){u(this).text()==a.name&&(u(s.single_level_container,i).removeClass("active"),u(this).parent().parent().addClass("active"))}),a},changeFrequency:function(l,e,t,o){u(o.single_level_summary_selector).each(function(){var e=u(o.amount_viewer,u(this)).text(),t=u(o.amount_viewer,u(this)).data("month"),n=u(o.amount_viewer,u(this)).data("year"),i=u(o.amount_viewer,u(this)).data("one-time"),s=l.split(" - ")[0],a=parseInt(l.split(" - ")[1]);u(o.frequency_selector_in_levels).val(l),u(o.frequency_selector_in_levels).prop("selected",l),"per month"==s?(e=t,u(o.amount_viewer,u(this)).removeClass("smaller")):"per year"==s?(e=n,u(o.amount_viewer,u(this)).addClass("smaller")):"one-time"==s&&(e=i,u(o.amount_viewer,u(this)).addClass("smaller")),u(o.amount_viewer,u(this)).text(e),u(o.frequency_selector_in_levels,u(this)).data("frequency",a)})},changeAmountPreview:function(a,e,t,l){u(l.single_level_summary_selector).each(function(){var e=u(l.amount_viewer,u(this)).text(),t=u(l.amount_viewer,u(this)).data("month"),n=u(l.amount_viewer,u(this)).data("year"),i=u(l.amount_viewer,u(this)).data("one-time"),s=a.split(" - ")[0];"per month"==s?(e=t,u(l.amount_viewer,u(this)).removeClass("smaller")):"per year"==s?(e=n,u(l.amount_viewer,u(this)).addClass("smaller")):"one-time"==s&&(e=i,u(l.amount_viewer,u(this)).addClass("smaller")),u(l.amount_viewer,u(this)).text(e)})},startLevelClick:function(n,i){u(".start-level").click(function(){var e=u(this).prop("class"),t=e[e.length-1];u(i.single_level_summary_selector,n).removeClass("flipped"),u(i.single_level_container,n).removeClass("active"),u(i.single_level_container+"-"+t,n).addClass("active"),u(i.single_level_container+"-"+t+" "+i.single_level_summary_selector).addClass("flipped")})}},u.fn[i]=function(e){return this.each(function(){u.data(this,"plugin_"+i)||u.data(this,"plugin_"+i,new a(this,e))})}}(jQuery,window,document,MinnPostMembership),function(i,e,t){var n="minnpostTrackSubmit",s={type:"event",category:"Support Us",action:"Become A Member",label:location.pathname};function a(e,t){this.element=e,this.options=i.extend({},s,t),this._defaults=s,this._name=n,this.init()}a.prototype={init:function(){var t=this,n=this.options;i(this.element).submit(function(e){t.analyticsEventTrack(n.type,n.category,n.action,n.label)})},analyticsEventTrack:function(e,t,n,i,s){"undefined"!=typeof ga&&(void 0!==s?ga("send",e,t,n,i,s):ga("send",e,t,n,i))}},i.fn[n]=function(e){return this.each(function(){i.data(this,"plugin_"+n)||i.data(this,"plugin_"+n,new a(this,e))})}}(jQuery,window,document);